<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="api-base" content="http://127.0.0.1:8000">
    <script>
      (function(){
        try {
          var host = window.location.hostname || '';
          if (host === 'localhost' || host === '127.0.0.1') {
            window.API_BASE_URL = 'http://127.0.0.1:8000';
          } else if (host.endsWith('onrender.com')) {
            window.API_BASE_URL = 'https://masinga-ngcdf-bursary.onrender.com';
          } else {
            var meta = document.querySelector('meta[name="api-base"]');
            if (meta && meta.content) {
              window.API_BASE_URL = meta.content;
            }
          }
        } catch (e) {}
      })();
    </script>
    <title>Bursary Application Form - Masinga NG-CDF</title>
    <link rel="stylesheet" href="assets/css/global.css">
    <link rel="stylesheet" href="assets/css/bursary.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
</head>

<body>
          <header>
    <div class="header-left">
        <h1>
            <img src="assets/images/cdf-logo.jpg" alt="Masinga Logo" class="logo">
            Masinga NG-CDF Website
        </h1>
    </div>
    <div class="header-right">
        <nav>
            <ul>
                <li><a href="index.html"><i class="fas fa-home"></i> Home</a></li>
                <li><a href="bursary-application-form.html" class="active"><i class="fas fa-file-alt"></i> Apply</a></li>
            </ul>
        </nav>
        <button class="theme-toggle" id="theme-toggle" aria-label="Toggle theme">ðŸŒ™</button>
        <button class="menu-toggle" aria-label="Toggle menu">â˜°</button>
    </div>
</header>
    <section id="bursary-form">
        <h2>Bursary Application Form</h2>

        <div style="display:flex; gap:10px; margin-bottom:16px;">
            <button type="button" id="show-apply-btn" class="success-action-btn secondary"><i class="fas fa-file-alt"></i> Apply</button>
            <button type="button" id="show-status-btn" class="success-action-btn"><i class="fas fa-search"></i> Check Status</button>
            <button type="button" id="show-edit-btn" class="success-action-btn"><i class="fas fa-pen-to-square"></i> Edit Application</button>
        </div>
       <div class="notice-box" style="background:#fff3cd; border:1px solid #ffc107; padding:12px; border-radius:6px; margin:12px 0;">
            <strong>Read and follow all instructions carefully:</strong>
            <ul style="margin:8px 0 0 18px;">
                <li>Eligible applicants are STRICT Masinga residents only. Applications with false information or non-residency will be disqualified.</li>
                <li>This online form is for Tertiary level applicants (certificate, diploma, artisan, degree) only.</li>
                 <li>âš  All required documents MUST be uploaded as clear phone photos (JPG or PNG only). 
PDF, Word, zip or scanned document formats will be automatically rejected.</li>
                <li><strong>UPLOAD A PHOTO OF YOUR ID OR BIRTH CERTIFICATE</strong></li>


                <li>You MUST upload a signed and stamped letter from your area Chief/Sub-Chief.</li>
                <li>First-year students must upload their Admission Letter. Continuing students must upload their latest Academic Transcript.</li>
                <li>If you have a disability, upload supporting documentation.</li>
                <li>If you are from a single-parenthood household, upload proof of single-parenthood status. If your parent is deceased, upload their death certificate and proof that you are their child/sibling.</li>
                                <li><strong>FILL ALL MANDATORY FIELDS BEFORE SUBMISSION</strong></li>

                <!-- CONTACT INFORMATION ADDED -->
                <li style="background: #e7f3ff; padding: 8px; border-radius: 4px; margin-top: 8px;">
                    <strong><i class="fas fa-phone-alt"></i> For assistance contact: 0113781366 or 0722759218 or 0707318176</strong>
                </li>
            </ul>
        </div>
       <form id="bursaryApplicationForm">
   
            <!-- Personal Information -->
            <fieldset>
                <legend><i class="fas fa-user"></i> Personal Information</legend>

                <label for="full-name"><i class="fas fa-id-card"></i> Full Name:</label>
                <input type="text" id="full-name" name="full-name" required>
               
                <!-- Updated: Applicant Photo is now optional -->
                <label for="applicant-photo"><i class="fas fa-camera"></i> Applicant Photo (Optional):</label>
                <input 
                    type="file" 
                    id="applicant-photo" 
                    name="applicant-photo" 
                    accept=".jpg,.jpeg,.png" 
                    title="Upload clear photo of yourself (JPG/PNG) â€” Max size: 5MB">
                <small class="hint">Clear recent photo for identification purposes (recommended but not required).</small>

                <div class="form-group">
                    <label for="email">Email Address:</label>
                    <input 
                        type="email" 
                        id="email" 
                        name="email" 
                        class="form-control" 
                        placeholder="Enter your valid email address" 
                        required 
                    />
                </div>

                <label for="gender"><i class="fas fa-venus-mars"></i> Gender:</label>
                <select id="gender" name="gender" required>
                    <option value="male">Male</option>
                    <option value="female">Female</option>
                </select>

                <label for="disability"><i class="fas fa-wheelchair"></i> Disability:</label>
                <input type="checkbox" id="disability" name="disability">
                <small id="disability-hint" class="hint">If checked, upload official medical/disability documentation.</small>

                <label for="disability-proof"><i class="fas fa-file-upload"></i> Disability Supporting Document (required if disability is selected):</label>
                <input type="file" id="disability-proof" name="disability-proof" accept=".jpg,.jpeg,.png,.pdf" aria-describedby="disability-hint">

                <label for="id-number"><i class="fas fa-id-badge"></i> National ID/Birth Certificate:</label>
                <input type="text" id="id-number" name="id-number" required inputmode="numeric" pattern="^\d{4,12}$" placeholder="Numeric only">

                <label for="id-upload-front">
                    <i class="fas fa-upload"></i> Upload Front Side of National ID/Birth Certificate:
                </label>
                <input 
                    type="file" 
                    id="id-upload-front" 
                    name="id-upload-front" 
                    accept=".jpg,.jpeg,.png" 
                    required 
                    title="Upload clear image (.jpg, .jpeg, .png) â€” Max size: 5MB">

                <label for="id-upload-back">
                    <i class="fas fa-upload"></i> Upload Back Side of National ID:(Optional)
                </label>
                <input 
                    type="file" 
                    id="id-upload-back" 
                    name="id-upload-back" 
                    accept=".jpg,.jpeg,.png" 
                    title="Upload clear image (.jpg, .jpeg, .png) â€” Max size: 5MB">

                <label for="phone-number"><i class="fas fa-phone-alt"></i> Phone Number:</label>
                <input type="tel" id="phone-number" name="phone-number" required inputmode="numeric" pattern="^(\+254(7|1)\d{8}|0(7|1)\d{8})$" placeholder="07XXXXXXXX / 01XXXXXXXX or +2547/1XXXXXXXX">

                <label for="guardian-phone"><i class="fas fa-user-shield"></i> Guardian's/Parent's Mobile Number:</label>
                <input type="tel" id="guardian-phone" name="guardian-phone" required inputmode="numeric" pattern="^(\+254(7|1)\d{8}|0(7|1)\d{8})$" placeholder="07XXXXXXXX / 01XXXXXXXX or +2547/1XXXXXXXX">

                <label for="guardian-id"><i class="fas fa-id-card-alt"></i> Guardian's/Parent's ID:</label>
                <input type="text" id="guardian-id" name="guardian-id" required inputmode="numeric" pattern="^\d{4,12}$" placeholder="Numeric only">
            </fieldset>
 
            <!-- Residence Details -->
            <fieldset>
                <legend><i class="fas fa-home"></i> Residence Details</legend>

                <label for="ward"><i class="fas fa-map-marker-alt"></i> Ward:</label>
                <select id="ward" name="ward" required>
                    <option value="kivaa">Kivaa</option>
                    <option value="masinga-central">Masinga Central</option>
                    <option value="ndithini">Ndithini</option>
                    <option value="ekalakala">Ekalakala</option>
                    <option value="muthesya">Muthesya</option>
                </select>

                <label for="village"><i class="fas fa-city"></i> Village:</label>
                <input type="text" id="village" name="village" required>

                <label for="chief-name"><i class="fas fa-user-tie"></i> Chief's Name:</label>
                <input type="text" id="chief-name" name="chief-name" required>

                <label for="chief-phone"><i class="fas fa-phone-alt"></i> Chief's Phone Number:</label>
                <input type="tel" id="chief-phone" name="chief-phone" required inputmode="numeric" pattern="^(\+254(7|1)\d{8}|0(7|1)\d{8})$" placeholder="07XXXXXXXX / 01XXXXXXXX or +2547/1XXXXXXXX">

                <label for="sub-chief-name"><i class="fas fa-user-tie"></i> Sub-Chief's Name:</label>
                <input type="text" id="sub-chief-name" name="sub-chief-name" required>

                <label for="sub-chief-phone"><i class="fas fa-phone-alt"></i> Sub-Chief's Phone Number:</label>
                <input type="tel" id="sub-chief-phone" name="sub-chief-phone" required inputmode="numeric" pattern="^(\+254(7|1)\d{8}|0(7|1)\d{8})$" placeholder="07XXXXXXXX / 01XXXXXXXX or +2547/1XXXXXXXX">

                <label for="chief-letter"><i class="fas fa-file-upload"></i> Letter from Chief/Sub-Chief (signed and stamped) â€” Mandatory:</label>
                <input type="file" id="chief-letter" name="chief-letter" accept=".jpg,.jpeg,.png,.pdf">
                <small class="hint">Must include official stamp and signature, plus date of issue.</small>
            </fieldset>

            <!-- Institution Details -->
            <fieldset>
                <legend><i class="fas fa-school"></i> Institution Details</legend>

                <label for="level-of-study"><i class="fas fa-graduation-cap"></i> Level of Study:</label>
                <select id="level-of-study" name="level-of-study" required onchange="toggleInstitutionDetails()">
                    <option value="degree">Degree</option>
                    <option value="certificate">Certificate</option>
                    <option value="diploma">Diploma</option>
                    <option value="artisan">Artisan</option>
                </select>

                <!-- College or University -->
                <label for="institution-type"><i class="fas fa-university"></i> Institution Type:</label>
                <select id="institution-type" name="institution-type" required onchange="toggleInstitutionFields()">
                    <option value="college">College</option>
                    <option value="university">University</option>
                </select>

                <!-- University or College Field (Name of Institution) -->
                <div id="institution-field">
                    <label for="institution-name"><i class="fas fa-building"></i> Name of Institution (as it appears in your admission letter):</label>
                    <input type="text" id="institution-name" name="institution-name" required>
                    <span style="color: red;">*Please ensure the name matches exactly with your admission letter.</span>
                </div>
                
                <label for="admission-number"><i class="fas fa-id-badge"></i> Admission/Registration Number:</label>
                <input type="text" id="admission-number" name="admission-number" required>

                <label for="amount"><i class="fas fa-money-bill-wave"></i> Amount Applied For (KSh):</label>
                <input type="number" id="amount" name="amount" required placeholder="e.g., 15000" min="1" step="1">

                <label for="mode-of-study"><i class="fas fa-user-clock"></i> Mode of Study:</label>
                <select id="mode-of-study" name="mode-of-study" required>
                    <option value="full-time">Full-time</option>
                    <option value="part-time">Part-time</option>
                </select>

                <label for="year-of-study"><i class="fas fa-calendar-alt"></i> Year of Study:</label>
                <select id="year-of-study" name="year-of-study" required>
                    <option value="first-year">First Year</option>
                    <option value="second-year">Second Year</option>
                    <option value="third-year">Third Year</option>
                    <option value="fourth-year">Fourth Year</option>
                    <option value="fifth-year">Fifth Year</option>
                    <option value="sixth-year">Sixth Year</option>
                    <option value="seventh-year">Seventh Year</option>
                </select>

                <!-- Add admission letter field -->
                <label for="admission-letter"><i class="fas fa-file-upload"></i> Admission Letter (First-year students only; required):</label>
                <input type="file" id="admission-letter" name="admission-letter" accept=".jpg,.jpeg,.png,.pdf">
                <small class="hint">Must match the institution name provided above.</small>

                <label for="transcript"><i class="fas fa-file-upload"></i> Latest Academic Transcript (Continuing students; required):</label>
                <input type="file" id="transcript" name="transcript" accept=".jpg,.jpeg,.png,.pdf">
                <small class="hint">Ensure the transcript includes your full name and registration number.</small>
            </fieldset>
            
            <!-- Family Details -->
            <fieldset>
                <legend><i class="fas fa-users"></i> Family Details</legend>

                <label for="family-status"><i class="fas fa-home"></i> Family Status:</label>
                <select id="family-status" name="family-status" required onchange="toggleFamilyProof()">
                    <option value="both-parents-alive">Both Parents Alive</option>
                    <option value="single-parent">Single Parent</option>
                    <option value="partial-orphan">Partial Orphan</option>
                    <option value="total-orphan">Total Orphan</option>
                </select>

                <!-- Single Parent Proof (shown for single-parent and partial-orphan) -->
                <div id="single-parent-proof-container" style="display:none;">
                    <label for="single-parent-proof"><i class="fas fa-file-upload"></i> Proof of Single-Parent Status (signed and stamped):</label>
                    <input type="file" id="single-parent-proof" name="single-parent-proof" accept=".jpg,.jpeg,.png,.pdf">
                    <small class="hint">For example, a Chief/Sub-Chief letter clearly stating the single-parent status.</small>
                    
                    <!-- Death certificate for deceased single parent -->
                    <div id="deceased-single-parent-container" style="display:none; margin-top:10px;">
                        <label for="deceased-single-parent-certificate"><i class="fas fa-file-upload"></i> Death Certificate of Single Parent:</label>
                        <input type="file" id="deceased-single-parent-certificate" name="deceased-single-parent-certificate" accept=".jpg,.jpeg,.png">
                        <small class="hint">Required if the single parent is deceased (total orphan situation).</small>
                    </div>
                </div>

                <!-- Orphan Proof (Only shown if Total Orphan is selected) -->
                <div id="orphan-proof" style="display: none;">
                    <label for="father-death-certificate"><i class="fas fa-file-upload"></i> Father's Death Certificate:</label>
                    <input type="file" id="father-death-certificate" name="father-death-certificate" accept=".jpg,.jpeg,.png">

                    <label for="mother-death-certificate"><i class="fas fa-file-upload"></i> Mother's Death Certificate:</label>
                    <input type="file" id="mother-death-certificate" name="mother-death-certificate" accept=".jpg,.jpeg,.png">

                    <div id="orphan-sibling-proof-container" style="display:none;">
                        <label for="orphan-sibling-proof"><i class="fas fa-file-upload"></i> Proof of being a child/sibling of the deceased parent(s):</label>
                        <input type="file" id="orphan-sibling-proof" name="orphan-sibling-proof" accept=".jpg,.jpeg,.png,.pdf">
                        <small class="hint">Acceptable: birth certificate, sworn affidavit, or other official proof.</small>
                    </div>
                </div>

                <!-- Father's and Mother's Income (only if not orphan) -->
                <div id="income-fields">
                    <label for="father-income"><i class="fas fa-wallet"></i> Father's Income (per month):</label>
                    <select id="father-income" name="father-income">
                        <option value="low">Low (KSh 1,000 â€“ 10,000)</option>
                        <option value="medium">Medium (KSh 10,001 â€“ 30,000)</option>
                        <option value="high">High (KSh 30,001 â€“ 50,000)</option>
                    </select>

                    <label for="mother-income"><i class="fas fa-wallet"></i> Mother's Income (per month):</label>
                    <select id="mother-income" name="mother-income">
                        <option value="low">Low (KSh 1,000 â€“ 10,000)</option>
                        <option value="medium">Medium (KSh 10,001 â€“ 30,000)</option>
                        <option value="high">High (KSh 30,001 â€“ 50,000)</option>
                    </select>
                </div>
            </fieldset>

            <!-- Data Protection Consent -->
            <fieldset>
                <legend><i class="fas fa-shield-alt"></i> Data Protection Consent</legend>
                
                <div class="consent-section">
                    <h3>Kenya Data Protection Act Consent</h3>
                    <div class="consent-text">
                        <p>In accordance with the Data Protection Act, 2019 of Kenya, we are required to inform you about how your personal data will be used and to obtain your consent for processing.</p>
                        
                        <h4>Purpose of Data Collection:</h4>
                        <p>Your personal information is being collected for the purpose of processing your bursary application with Masinga NG-CDF. This includes:</p>
                        <ul>
                            <li>Verifying your eligibility for the bursary</li>
                            <li>Contacting you regarding your application status</li>
                            <li>Processing and disbursing funds if approved</li>
                            <li>Maintaining records as required by law</li>
                        </ul>
                        
                        <h4>Data Sharing:</h4>
                        <p>Your information may be shared with:</p>
                        <ul>
                            <li>Masinga NG-CDF Committee members</li>
                            <li>Relevant government agencies for verification purposes</li>
                            <li>Educational institutions for confirmation of admission</li>
                        </ul>
                        
                        <h4>Data Retention:</h4>
                        <p>Your data will be retained for a period of 7 years as required by Kenyan law for financial records, after which it will be securely disposed of.</p>
                        
                        <h4>Your Rights:</h4>
                        <p>You have the right to:</p>
                        <ul>
                            <li>Access your personal data</li>
                            <li>Request correction of inaccurate data</li>
                            <li>Withdraw consent (though this may affect your application)</li>
                            <li>Lodge a complaint with the Office of the Data Protection Commissioner</li>
                        </ul>
                    </div>
                    
                    <div class="consent-checkboxes">
                        <label for="data-consent">
                            <input type="checkbox" id="data-consent" name="data-consent" required>
                            <strong>I hereby consent to the collection, processing, and storage of my personal data as described above for the purpose of my bursary application.</strong>
                        </label>
                        
                        <label for="communication-consent">
                            <input type="checkbox" id="communication-consent" name="communication-consent">
                            I consent to receive communications regarding my application via email and SMS
                        </label>
                    </div>
                </div>
            </fieldset>

            <div class="disclaimer" style="background:#fee; border:1px solid #f5c2c7; color:#842029; padding:12px; border-radius:6px; margin:12px 0;">
                <strong>Disclaimer:</strong>
                <ul style="margin:8px 0 0 18px;">
                    <li>Any false information will lead to immediate disqualification.</li>
                    <li>Applicants must be voter residents of Masinga constituency. Non-residents will be disqualified.</li>
                    <li>Applicants must obtain a letter from their area Chief or Sub-Chief, duly signed and stamped, and upload it here.</li>
                </ul>
            </div>
            <!-- Confirmation -->
            <fieldset>
                <legend><i class="fas fa-check-circle"></i> Confirmation</legend>

                <label for="residency-confirm">
                    <i class="fas fa-map-marker-alt"></i> I confirm that I am a resident of Masinga Constituency:
                </label>
                <input type="checkbox" id="residency-confirm" name="residency-confirm" required>

                <label for="confirmation">
                    <i class="fas fa-exclamation-circle"></i> I confirm all details are correct:
                </label>
                <input type="checkbox" id="confirmation" name="confirmation" required>
            </fieldset>

            <!-- Submit Button - change type to button -->
            <button type="button" id="submit-btn">
                <i class="fas fa-paper-plane"></i> Submit Application
            </button>
            
            <!-- Add loading and message sections -->
            <div id="loading" style="display: none;">
                <p><i class="fas fa-spinner fa-spin"></i> Submitting your application...</p>
            </div>
            <div id="upload-progress" style="display:none;">
                <div id="upload-bar"></div>
                <div id="upload-percent">0%</div>
            </div>
            
            <!-- Error message only - success message removed -->
            <div id="error-message" style="display: none; color: red;" role="alert" aria-live="assertive" tabindex="-1">
                <h2>Error Submitting Application</h2>
                <p id="error-text"></p>
            </div>
        </form>

        <!-- Embedded Status Checker -->
        <div id="status-section" style="display:none; margin-top:12px;">
            <fieldset>
                <legend><i class="fas fa-info-circle"></i> Check Your Application Status</legend>
                <label for="embedded-ref-input"><i class="fas fa-bookmark"></i> Reference Number</label>
                <input type="text" id="embedded-ref-input" placeholder="e.g., MNG-XXXXXXX">
                <button type="button" id="embedded-check-status-btn" class="success-action-btn" style="margin-top:8px;">
                    <i class="fas fa-search"></i> Check Status
                </button>

                <div id="embedded-status-error" style="display:none; color:#bb0000; margin-top:1rem;" role="alert" aria-live="assertive"></div>

                <div id="embedded-status-result" style="display:none; margin-top:1rem;">
                    <div class="application-summary-box">
                        <h4 style="color: #006400; margin-bottom: 15px;">
                            <i class="fas fa-clipboard-check"></i> Application Details
                        </h4>
                        <div class="summary-item"><span class="summary-label">Reference Number:</span><span class="summary-value" id="emb-res-ref"></span></div>
                        <div class="summary-item"><span class="summary-label">Applicant Name:</span><span class="summary-value" id="emb-res-name"></span></div>
                        <div class="summary-item"><span class="summary-label">Institution:</span><span class="summary-value" id="emb-res-institution"></span></div>
                        <div class="summary-item"><span class="summary-label">Amount Requested:</span><span class="summary-value">KSh <span id="emb-res-amount"></span></span></div>
                        <div class="summary-item"><span class="summary-label">Ward:</span><span class="summary-value" id="emb-res-ward"></span></div>
                        <div class="summary-item"><span class="summary-label">Submitted:</span><span class="summary-value" id="emb-res-submitted"></span></div>
                        <div class="summary-item"><span class="summary-label">Current Status:</span><span class="summary-value" id="emb-res-status" style="font-weight:bold;"></span></div>
                    </div>
                </div>
            </fieldset>
        </div>

        <!-- Embedded Edit Application -->
        <div id="edit-section" style="display:none; margin-top:12px;">
            <fieldset>
                <legend><i class="fas fa-pen-to-square"></i> Edit Your Application (within 24 hours)</legend>
                <label for="edit-ref-input"><i class="fas fa-bookmark"></i> Reference Number</label>
                <input type="text" id="edit-ref-input" placeholder="e.g., MNG-XXXXXXX">
                <label for="edit-email-input"><i class="fas fa-envelope"></i> Email used in application</label>
                <input type="email" id="edit-email-input" placeholder="your@email.com">
                <button type="button" id="edit-load-btn" class="success-action-btn" style="margin-top:8px;">
                    <i class="fas fa-unlock-keyhole"></i> Load for Edit
                </button>
                <div id="edit-error" style="display:none; color:#bb0000; margin-top:1rem;" role="alert" aria-live="assertive"></div>
                <div id="edit-hint" style="display:none; margin-top:1rem; background:#fff3cd; border:1px solid #ffc107; padding:10px; border-radius:6px;">
                    You are now editing your submitted application. Only allowed fields will be updated.
                </div>
            </fieldset>
        </div>
    </section>

    <footer>
        <p>&copy; 2025 Masinga NG-CDF. All Rights Reserved.</p>
        <p><i class="fas fa-phone-alt"></i> Contact: 0113781366 or 0722759218 or 0707318176</p>
        <p>Created by Jude Kioko</p>
    </footer>
    <button id="back-to-top" class="back-to-top" aria-label="Back to top">â†‘</button>
  
    
    <script defer src="assets/js/global.js"></script>
    <script defer src="assets/js/bursary.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    </body>
    </html>